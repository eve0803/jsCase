<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>点击往下掉，再点击飘回来</title>
</head>
<body>
<script src="base.js"></script>
<script>
    (function(){
        var str='';
        var len=20;
        var timer=null;
        var flag=true;//flag代表方向
        var finished=true;
        var num = 0;
        var render=function(){
           for ( var i=0; i<len; i++ ) {
               str += '<div style="width:50px; height:50px; background:red; position:absolute; top:0px; left:'+ i*60 +'px;"></div>';
           }

           document.body.innerHTML = str;
       };
        document.onclick = function () {
         var div=document.getElementsByTagName('div');
            if(!finished){return;}//如果一点击，前一轮还在运行就直接退出
            finished=false;
            clearInterval(timer);
            timer=setInterval(function(){
                doMove( div[num], 'top', 23,  flag?500:0,num == len - 1 ? function(){
                    finished = true; //当且仅当最后一个aDiv落定的时候，finished才算完成，改为true
                    flag = !flag;
                    // alert("完成了一轮！");
                } : null);
                num ++;
                if ( num === len ) {
                    clearInterval( timer );
                    num = 0;
                }
            },100);

        };
        render();
    })();
</script>
</body>
</html>